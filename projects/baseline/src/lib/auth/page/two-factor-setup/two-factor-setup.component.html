<base-auth-card
    [cardTitle]="'auth.pages.2fa.setup.title' | translate"
    [loaded]="userLoaded() && setupLoaded"
>
    <div *ngIf="twoFactorInfo()" class="">
        <p>{{ 'auth.pages.2fa.setup.description' | translate }}</p>
        <div class="w-full flex flex-col items-center">
            <div class="w-full flex flex-col items-center gap-1">
                <qr-code [value]="twoFactorInfo()!!.optAuthUrl" [size]="200"/>
                <span class="text-xs">{{ twoFactorInfo()?.secret }}</span>
            </div>
        </div>

        <div class="flex flex-col items-center gap-2 py-2">
            <p class="w-full font-bold">{{ 'auth.pages.2fa.setup.recovery_description' | translate }}</p>

            <div class="flex flex-wrap gap-1 w-80">
                <pre *ngFor="let code of twoFactorInfo()!!.recoveryCodes" class="flex-1">{{ code }}</pre>
            </div>

            <div class="flex items-center gap-2 w-full">
                <base-checkbox inputId="agree" [(ngModel)]="agreed"/>
                <label for="agree">{{ 'auth.pages.2fa.setup.recovery_agree' | translate }}</label>
            </div>
        </div>

        <base-divider/>

        <div class="w-full flex flex-col gap-2 items-center">
            <p class="w-full">Enter your code</p>
            <base-input-otp [(ngModel)]="code"/>
            <base-button
                [disabled]="!agreed || code.length !== 6"
                [label]="'Setup'"
                (onClick)="setup()"
            />
        </div>
    </div>
</base-auth-card>
